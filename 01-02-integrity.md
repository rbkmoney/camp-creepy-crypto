class: animation-fade
layout: true

---

class: impact

# –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è
## –±–µ–∑ –∫—Ä–∏–ø—Ç–æ–∫—É–ø—é—Ä

---

# MAC

–°–æ–∫—Ä–∞—â—ë–Ω–Ω–æ **M**essage **A**uthentication **C**ode.

--

## –ó–∞–¥–∞—á–∏
--

* –∫–æ–Ω—Ç—Ä–æ–ª—å _—Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏_ —Å–æ–æ–±—â–µ–Ω–∏–π,

--

* –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è _–∞—É—Ç–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏_ —Å–æ–æ–±—â–µ–Ω–∏–π.

--

## –ê–ª–≥–æ—Ä–∏—Ç–º

–°–æ—Å—Ç–æ—è—â–∏–π –∏–∑ $ (S, V) $, –≥–¥–µ

$ t \leftarrow S(k, m) $

$ v \leftarrow V(k, m, t), v \in \\{valid, invalid\\} $

### –ù—É–∂–µ–Ω –∫–ª—é—á, –∏–Ω–∞—á–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å _–∞—É—Ç–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å_ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ!

---

# MAC

## –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å

--

* –ù–∞–¥—ë–∂–µ–Ω –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –Ω–µ –º–æ–∂–µ—Ç –≤ _Existential Forgery_.

--

    - —Å–ª–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å $ (m_i, t^\prime) $, –≥–¥–µ $ t^\prime \neq t_i $
--
    - —Å–ª–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å $ (m^\prime, t^\prime) \notin \\{ (m_1, t_1) .. (m_n, t_n) \\} $

--

### –ò–≥—Ä–∞ —Å–æ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–º

* –°—É–¥—å—è –≤—ã–±–∏—Ä–∞–µ—Ç —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á $ k $.
* –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç $ q $ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å—É–¥—å–µ.
* –°—É–¥—å—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç $ S(k,m_1) .. S(k,m_q) $ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É.
* –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—É–¥—å–µ $ (m,t) \notin \\{ (m_1, t_1) .. (m_q, t_q) \\} $

–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ $ V(k,m,t) = valid $ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å _–∫—Ä–∞–π–Ω–µ –º–∞–ª–∞_!

---

# MAC

## –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

* –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å $ AES(k, \cdot) $ –≤ –∫–∞—á–µ—Å—Ç–≤–µ MAC? 
--
–ú–æ–∂–Ω–æ. 

--

* –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –¥–ª–∏–Ω–∞ –±–ª–æ–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞. 
--
Here comes _CBC-MAC_.

---

# MAC

## CBC-MAC

.col-8[
    <img style="width: 100%;" src="assets/cbc-mac.png" />
]

–í –∫–∞—á–µ—Å—Ç–≤–µ $ F $ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AES:

$ AES(k_1, \\\\ \\quad AES(k, m[n] \oplus \\\\ \\qquad AES(k, m[n-1] \oplus \\\\ \\qquad \\quad ... \\\\ \\qquad \\qquad AES(k, m[0])))) $

---

# MAC

## CBC-MAC

–ß—Ç–æ –µ—Å–ª–∏ –¥–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –∫—Ä–∞—Ç–Ω–∞ —Ä–∞–∑–º–µ—Ä—É –±–ª–æ–∫–∞? üôÑ 
--
–ö–æ–Ω–µ—á–Ω–æ –∂–µ –¥–æ–±–∞–≤–∏—Ç—å _padding_.

--

<img style="width: 100%;" src="assets/cbc-mac-pad.png" />

--

–ü–æ—á–µ–º—É –±—ã –ø—Ä–æ—Å—Ç–æ –Ω–µ –¥–æ–±–∞–≤–∏—Ç—å –∫—É—á—É –Ω—É–ª–µ–π?

<img style="width: 100%;" src="assets/cbc-mac-bad-pad.png" />

--
üôÖ

---

# MAC

## –•—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

–•—ç—à-—Ñ—É–Ω–∫—Ü–∏—è $ H(m) = t $, –≥–¥–µ $ m \in M, t \in T $.

--

* –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è

--

* $ |M| \gg |T| $

--

* _–ö—Ä–∞–π–Ω–µ —Å–ª–æ–∂–Ω–æ_ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å $ m $, –∏–º–µ—è –Ω–∞ —Ä—É–∫–∞—Ö $ t $

--

* –ù–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ $ m $ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–º –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –≤ $ t $

--

* –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –∫–æ–ª–ª–∏–∑–∏—è–º (Collision Resistance)

    - –ö–æ–ª–ª–∏–∑–∏—è ‚Äì —ç—Ç–æ –ø–∞—Ä–∞ $ m_0,m_1 \in M $, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö $ H(m_0) = H(m_1) $

--
    - –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É –Ω–∞–π—Ç–∏ –∫–æ–ª–ª–∏–∑–∏—é –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å _–∫—Ä–∞–π–Ω–µ –º–∞–ª–∞_!

---

# MAC

## SHA-256

* –†–∞–∑–º–µ—Ä —Ö—ç—à–∞ 256 –±–∏—Ç, $ |T| = 2^{256} $.

    <img style="width: 95%;" src="assets/mg.png" />

--

* –§—É–Ω–∫—Ü–∏—è –∫–æ–º–ø—Ä–µ—Å—Å–∏–∏ $ h(H,m) = H^\prime, m \in \\{0,1\\}^{512} $

--

* –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏ $ h(H,m) = E(m,H) \oplus H $, –≥–¥–µ $ E $ ‚Äì —Å—Ö–µ–º–∞ –±–ª–æ—á–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è SHACAL-2.

--

* Padding –≤–∏–¥–∞ $ 1000..0 \\| length(m) $.

---

# MAC

## –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

--

* –•—ç—à-—Ñ—É–Ω–∫—Ü–∏—è –Ω–µ –¥–∞—ë—Ç –Ω–∞–º –∫–æ–Ω—Ç—Ä–æ–ª—è _–∞—É—Ç–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏_.

--

* –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ–±—ã —ç—Ç–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å? 
--
Here comes _HMAC_ (Hash-based MAC).

---

# MAC

## HMAC

–í–∑—è–≤ –≤ —Ä—É–∫–∏ SHA-256 –∫–∞–∫ _—É—Å—Ç–æ–π—á–∏–≤—É—é –∫ –∫–æ–ª–ª–∏–∑–∏—è–º_ —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏—é –º—ã –º–æ–∂–µ–º –ø–æ—Å—Ç—Ä–æ–∏—Ç—å _—É—Å—Ç–æ–π—á–∏–≤—É—é –∫ –ø–æ–¥–¥–µ–ª–∫–µ (forgery)_ —Å—Ö–µ–º—É MAC.

--

* $ S(k,m) := H(k \oplus opad \\| H(k \oplus ipad \\| m)) $

* $ V(k,m,t) := S(k,m) = t $

--

–ß—Ç–æ–±—ã –≤–Ω–µ—à–Ω–∏–π –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–ª—é—á–∏ –∏–º–µ–ª–∏ _–º–µ–Ω—å—à–µ_ —Å–æ–≤–ø–∞–¥–∞—é—â–∏—Ö –±–∏—Ç:

* $ ipad := 0x363636..36 $

* $ opad := 0x5c5c5c..5c $

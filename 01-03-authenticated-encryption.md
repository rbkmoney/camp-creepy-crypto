class: animation-fade
layout: true

---

class: impact

# –ö—Ä–∏–ø–æ—Ç–Ω–∞—è
## –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è

---

# –ì–∞—Ä–∞–Ω—Ç–∏–∏

--

## –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å

- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–∑–≤–ª–µ—á—å –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –Ω–æ –º–æ–∂–Ω–æ –ø–æ–¥–¥–µ–ª–∞—Ç—å.

- –°—Ö–µ–º–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (cipher): $ c \leftarrow E(k, m) $, $ m \leftarrow D(k, c) $.

--

## –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å

- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–¥–¥–µ–ª–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –Ω–æ –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å –∏ –ø—Ä–æ—á–∏—Ç–∞—Ç—å.

- –°—Ö–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏ (MAC): $ t \leftarrow S(k, m) $, $ \\{0,1\\} \leftarrow V(k, m, t) $.

--

### –ß—Ç–æ –µ—Å–ª–∏ –Ω–∞–º –Ω—É–∂–Ω–æ –∏ —Ç–æ –∏ –¥—Ä—É–≥–æ–µ?

---

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

> **A**uthenticated **E**ncryption

--

## –°—Ö–µ–º–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

$ c \leftarrow E(k, m) $, $ c \in C $

$ m \leftarrow D(k, m) $, 
--
$ m \in M \cup \\{ \bot \\} $

$ \bot $ –∏–ª–∏ $ reject $ ‚Äì _—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–º_.

--

–ö–∞–∫ —Å–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞—Ç—å? 
--
–ü–æ–ø—Ä–æ–±—É–µ–º —Å–∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–¥—ë–∂–Ω—É—é —Å—Ö–µ–º—É —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –Ω–∞–¥—ë–∂–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏.

---

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

## SSL 3.0

.col-6[

$ E_{SSL3}((k_e, k_m), m, E, S) := $

$ \\qquad t \leftarrow S(k_m,m) $

$ \\qquad pad \leftarrow \\{0..255\\}^{l\_{pad}-1} \\| l_{pad}-1 $

$ \\qquad c \leftarrow E(k_e,m \\| t \\| pad) $

$ D_{SSL3}((k_e, k_m), c, E, V) := $

$ \\qquad m^{\\prime} \leftarrow D(k_e,c) $

$ \\qquad (m,t) \leftarrow m^{\\prime}[0..{l-l\_{pad}}], l_{pad} \leftarrow m^{\\prime}[l-1] $

$ \\qquad m \\> if \\> valid = V(k_m,m,t) \\> else \\> \bot $

]

--

.col-6[

### –ù–∞—Å–∫–æ–ª—å–∫–æ –Ω–∞–¥—ë–∂–Ω–∞ –¥–∞–Ω–Ω–∞—è —Å—Ö–µ–º–∞? 

]

--
.col-6[

–í—Å—ë –æ—á–µ–Ω—å –ø–ª–æ—Ö–æ. üò∞

]

---

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

## –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å

--

* –ó–∞—â–∏—â–∞–µ–º—Å—è –æ—Ç _–∞–∫—Ç–∏–≤–Ω–æ–≥–æ_ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞

    - –º–æ–∂–µ—Ç _–ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å_ —Å–æ–æ–±—â–µ–Ω–∏—è, –∫–∞–∫ –∏ —Ä–∞–Ω—å—à–µ (_eavesdropping_)
    - –º–æ–∂–µ—Ç _–º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å_ —Å–æ–æ–±—â–µ–Ω–∏—è (_tampering_)

--

* –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Å—Ç–∏ CCA (**C**hosen **C**iphertext **A**ttack)

--

    –°—ã–≥—Ä–∞–µ–º —Å –Ω–∏–º –≤ –æ–¥–Ω—É –∏–≥—Ä—É

    <img style="width: 200px;" src="http://playeject.com/wp-content/uploads/2011/07/saw-figure.jpg" />

---

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

## Chosen Ciphertext Attack

--

* –°—É–¥—å—è –≤—ã–±–∏—Ä–∞–µ—Ç —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á $ k \xleftarrow{R} K $ –∏ –¥–µ–ª–∞–µ—Ç –≤—ã–±–æ—Ä $ b \xleftarrow{R} \\{0,1\\} $

* –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–∞—Ä —Å–æ–æ–±—â–µ–Ω–∏–π $ (m\_{10},m\_{11}) .. (m\_{p0},m\_{p1}) $ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å—É–¥—å–µ

* –°—É–¥—å—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç $ c\_i = E(k,m\_{ib}) $ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ $ i \in \\{1..p\\} $ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É

* –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ $ \hat{c}\_j \notin \\{ c_1 .. c_p \\} $ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—É–¥—å–µ

* –°—É–¥—å—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç $ \hat{m}\_j = D(k,\hat{c}\_j) $ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ $ j \in \\{1..q\\} $ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—É–¥—å–µ

* –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –¥–µ–ª–∞–µ—Ç –¥–æ–≥–∞–¥–∫—É $ \hat{b} \in {0,1} $

–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ $ \hat{b} = b $ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å _–∫—Ä–∞–π–Ω–µ –º–∞–ª–∞_! 

---

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

## –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å

–°—Ö–µ–º–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–¥—ë–∂–Ω–∞ –≤ —É—Å–ª–æ–≤–∏—è—Ö CCA, –µ—Å–ª–∏:

* **–æ–Ω–∞ –Ω–∞–¥—ë–∂–Ω–∞ –≤ —É—Å–ª–æ–≤–∏—è—Ö CPA** –∏

* **–æ–Ω–∞ —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –ø–æ–¥–¥–µ–ª–∫–µ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞** (_Ciphertext Integrity_)

--

### –¢–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞ –æ–Ω–∞ –¥–æ—Å—Ç–æ–π–Ω–∞ –Ω–∞–∑—ã–≤–∞—Ç—Å—è _–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ö–µ–º–æ–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è_.

---

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

## –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

--

–ß—Ç–æ –µ—Å–ª–∏ –º—ã –≤–æ–∑—å–º—ë–º _CPA secure cipher_ + _unforgeable MAC_? 
--
üíñ

--

–ù–µ –≤—Å–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ –ø–æ–ª–µ–∑–Ω—ã. ü§¢

--

* Encrypt-then-MAC

* MAC-then-Encrypt

* MAC-and-Encrypt

---

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

## Encrypt-then-MAC

$ E_{etm}((k_e, k_m), m, E, S) := $

$ \\qquad c \leftarrow E(k_e,m) $

$ \\qquad t \leftarrow S(k_m,c) $

$ \\qquad (c,t) $

--

### –í—Å–µ–º —Ö–æ—Ä–æ—à–∞!

* –ì–ª–∞–≤–Ω–æ–µ ‚Äì –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª—é—á –¥–ª—è $ S $ –∏ $ E $

--

* ...–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å **–≤—Å–µ** –¥–∞–Ω–Ω—ã–µ, –≤ —Ç–æ–º —á–∏—Å–ª–µ IV 
--
<sub>(–ø—Ä–∏–º–µ—Ä: iOS –ø—è—Ç–∏–ª–µ—Ç–Ω–µ–π –¥–∞–≤–Ω–æ—Å—Ç–∏)</sub>.

---

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

## MAC-then-Encrypt

$ E_{mte}((k_e, k_m), m, E, S) := $

$ \\qquad t \leftarrow S(k_m,m) $

$ \\qquad c \leftarrow E(k_e,(m,t)) $

--

### –ù–µ –±—É–¥—å—Ç–µ –∫–∞–∫ SSL 3.0 
--
–∏ TLS 1.0

--

* –ú–Ω–æ–∂–µ—Å—Ç–≤–æ _padding oracle attack_

* –ü–∞—Ä–∞ _timing attack_

--

* –¢–µ–º –Ω–µ –º–µ–Ω–µ–µ **–º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –Ω–∞–¥—ë–∂–Ω—É—é —Å—Ö–µ–º—É —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è**, –Ω–æ –º–Ω–æ–≥–æ —Ç–æ–Ω–∫–æ—Å—Ç–µ–π

---

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

## Encrypt-and-MAC

$ E_{eam}((k_e, k_m), m, E, S) := $

$ \\qquad c \leftarrow E(k_e,m) $

$ \\qquad t \leftarrow S(k_m,m) $

$ \\qquad (c,t) $

--

### –¢–æ–∂–µ –Ω–µ–ø–ª–æ—Ö–æ!

--

* **–ú–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –Ω–∞–¥—ë–∂–Ω—É—é —Å—Ö–µ–º—É —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è**, 

--

* ...–Ω–æ –Ω–∞–¥–æ –±—ã—Ç—å –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã–º —Å –≤—ã–±–æ—Ä–æ–º $ E $

---

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

## –ö–æ–º–±–∏–Ω–∞—Ü–∏–∏

–ü–∞—Ä–∞ –≤–∞–∂–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤

--

* $ k_e \neq k_m $, –∏–Ω–∞—á–µ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å –ø–æ–¥ —É–≥—Ä–æ–∑–æ–π

--

* –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ $ D $ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–∞—Ç–æ–º–∞—Ä–Ω—ã–º**, 
--
–∏–Ω–∞—á–µ –±—É–¥–µ—Ç –∫–∞–∫ –≤ SSHv2 ü§ï

> Our attacks against OpenSSH, where we can verifiably recover 14 bits of plaintext from an arbitrary block of ciphertext with probability $ 2^{‚àí14} $ and 32 bits of plaintext from an arbitrary block of ciphertext with probability $ 2^{‚àí18} $.
> <cite>Plaintext Recovery Attacks Against SSH, Martin R. Albrecht et al.</cite>

---

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

## AEAD

–°—Ö–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Å –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (**A**uthenticated **E**ncryption with **A**ssociated **D**ata)

--

* –ü—Ä–∏–¥—É–º–∞–Ω—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –ª—é–¥–µ–π, –Ω–µ –∑–∞–Ω–∏–º–∞—é—â–∏—Ö—Å—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–µ–π <sub>–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–µ–Ω—è</sub>

--

* –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã, –Ω–æ –Ω–µ –≤—Å–µ ‚Äì –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã

    $ (c,d) \leftarrow E(k,m,d,nonce) $

    $ m \leftarrow D(k,m,d,nonce) $

    <img style="width: 80%;" src="assets/aead.png" />

---

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

## AEAD

* –ï—Å–ª–∏ $ |m| = 0 $, —Å –ª—ë–≥–∫–æ—Å—Ç—å—é –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ _MAC_.

* –ï—Å–ª–∏ $ |d| = 0 $, —Å –ª—ë–≥–∫–æ—Å—Ç—å—é –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ _AE cipher_.

--

## –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã

–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä—É—é—Ç—Å—è _CPA secure cipher_ $ E $, –Ω–∞–ø—Ä–∏–º–µ—Ä AES.

--

* **GCM** (Galois Counter Mode) <sub>= CTR + Carter Wegman MAC</sub>

--

* **EAX** (Encrypt-Authenticate-Translate) <sub>= CTR + One-key MAC</sub>

---

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

## OCB (Offset Codebook Mode)

<img style="width: 58%;" src="assets/ocm.png" />
--
<img style="width: 36%; padding-left: 40px;" src="assets/ocb-auth.png" />

--

* –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω –≤—ã–∑–æ–≤ $ E $ –Ω–∞ –æ–¥–∏–Ω –±–ª–æ–∫ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

* –ö—Ä–∞–π–Ω–µ –±—ã—Å—Ç—Ä–æ!

---

class: impact

# –û—Å—Ç–∞–ª–æ—Å—å
## —Å–æ–≤—Å–µ–º –Ω–µ–º–Ω–æ–≥–æ
